import{d as p,s as C,ap as g,h,y as M,o as E,c as y}from"./framework.DF6d_793.js";const v=t=>(t.install=r=>{r.component(t.name,t)},t),D={mapConfig:{type:Object},viewerConfig:{type:Object}},S={cesiumReady:t=>!0},T=["id"],_=p({name:"dls-map"}),x=p({..._,props:D,emits:S,setup(t,{expose:r,emit:m}){const e=t,c=m,i=e.mapConfig,s=C(null),n=g({}),o=h(()=>(i==null?void 0:i.id)||"cesiumContainer");return M(()=>{i!=null&&i.defaultAccessToken&&(Cesium.Ion.defaultAccessToken=i.defaultAccessToken);let a=new Cesium.Viewer(o.value,{baseLayerPicker:!1,geocoder:!1,animation:!1,shouldAnimate:!0,homeButton:!1,sceneMode:(i==null?void 0:i.sceneModeNum)===2?Cesium.SceneMode.SCENE2D:Cesium.SceneMode.SCENE3D,timeline:!1,fullscreenButton:!1,scene3DOnly:!1,sceneModePicker:!1,navigationInstructionsInitiallyVisible:!1,navigationHelpButton:!1,selectionIndicator:!1,infoBox:!1,imageryProvider:!1,...e.viewerConfig});(i!=null&&i.defaultAccessToken||i!=null&&i.imageryProvider)&&a.imageryLayers.addImageryProvider(new Cesium.UrlTemplateImageryProvider(i==null?void 0:i.imageryProvider)),a.cesiumWidget.screenSpaceEventHandler.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),s.value=a,c("cesiumReady",s.value)}),r({dataM:n,viewer:s}),(a,l)=>(E(),y("div",{id:o.value,style:{position:"absolute",width:"100%",height:"100%"},class:"dlsMapContainer"},null,8,T))}}),k=v(x);function F(){const t=g({longitude:"0",latitude:"0",height:"0",altitude:"0",cameraHeading:"0",pitchDegrees:"0",zoomLevel:0});function r(e=null){if(!e)return console.error("viewer is undefined"),!1;if(e){let c=null;const i=e.camera,s=new Cesium.ScreenSpaceEventHandler(e.scene.canvas);s.setInputAction(function(n){const o=e.camera.pickEllipsoid(n.endPosition,e.scene.globe.ellipsoid);o&&(c&&clearTimeout(c),c=setTimeout(()=>{const a=Cesium.Cartographic.fromCartesian(o);t.longitude=Cesium.Math.toDegrees(a.longitude).toFixed(6),t.latitude=Cesium.Math.toDegrees(a.latitude).toFixed(6)},300))},Cesium.ScreenSpaceEventType.MOUSE_MOVE),s.setInputAction(function(n){let o=n.position;if(o)if(e.scene.mode===Cesium.SceneMode.SCENE3D){let l=e.scene.globe.pick(e.camera.getPickRay(o),e.scene);if(l){let u=Cesium.Cartographic.fromCartesian(l);t.longitude=Cesium.Math.toDegrees(u.longitude).toFixed(6),t.latitude=Cesium.Math.toDegrees(u.latitude).toFixed(6);let d=e.scene.globe.ellipsoid.cartesianToCartographic(l);d&&(t.altitude=e.scene.globe.getHeight(d).toFixed(2))}}else{let l=e.camera.pickEllipsoid(o,e.scene.globe.ellipsoid);if(l!==void 0){let u=Cesium.Cartographic.fromCartesian(l),d=Cesium.Math.toDegrees(u.longitude),f=Cesium.Math.toDegrees(u.latitude);t.longitude=d.toFixed(6),t.latitude=f.toFixed(6)}}},Cesium.ScreenSpaceEventType.LEFT_CLICK),s.setInputAction(function(n){t.height=e.camera.positionCartographic.height.toFixed(1);let o=m(Math.ceil(e.camera.positionCartographic.height));t.zoomLevel=o},Cesium.ScreenSpaceEventType.WHEEL),e.scene.camera.moveEnd.addEventListener(function(){let n=i.direction,o=Cesium.Math.toDegrees(Math.atan2(n.y,n.x));t.cameraHeading=((o+360)%360).toFixed(0);let a=i.pitch;t.pitchDegrees=Cesium.Math.toDegrees(a).toFixed(0)})}}function m(e){let c=40487.57,i=7096758e-11,s=91610.74,n=-40467.74;return Math.round(n+(c-n)/(1+Math.pow(e/s,i)))}return{listenToMouseMovement:r,coords:t}}export{k as D,F as u};
